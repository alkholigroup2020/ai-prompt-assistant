var N=Object.defineProperty;var P=(s,e,t)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var T=(s,e,t)=>P(s,typeof e!="symbol"?e+"":e,t);import{e as U,W as x}from"./D_7VKaxR.js";const O=globalThis.setInterval;class _{constructor(){T(this,"cache");this.cache=new Map}get(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp>t.expiresIn?(this.cache.delete(e),null):t.data:null}set(e,t,i){this.cache.set(e,{data:t,timestamp:Date.now(),expiresIn:i})}has(e){return this.get(e)!==null}delete(e){this.cache.delete(e)}clear(){this.cache.clear()}clearExpired(){const e=Date.now();for(const[t,i]of this.cache.entries())e-i.timestamp>i.expiresIn&&this.cache.delete(t)}get size(){return this.cache.size}}const y=new _,w={ONE_MINUTE:60*1e3,FIVE_MINUTES:300*1e3};O(()=>{y.clearExpired()},w.FIVE_MINUTES);function A(){const e=x().public.appUrl||"";async function t(a,r={}){const{method:n="GET",body:l,retry:f=3,timeout:c=3e4,cache:u=!1,cacheTime:M=w.FIVE_MINUTES}=r,m=u?`${a}:${l?JSON.stringify(l):""}`:"";if(u&&m){const p=y.get(m);if(p!==null)return p}let g=null;for(let p=0;p<f;p++)try{const o=new AbortController,h=setTimeout(()=>o.abort(),c),d=await $fetch(a,{baseURL:e,method:n,body:l,signal:o.signal,headers:{"Content-Type":"application/json"}});return clearTimeout(h),u&&m&&d&&y.set(m,d,M),d}catch(o){if(g=o,o&&typeof o=="object"&&"statusCode"in o){const h=o.statusCode;if(h&&h>=400&&h<500)throw o}p<f-1&&await new Promise(h=>setTimeout(h,Math.pow(2,p)*1e3))}throw g}async function i(a){const r=U({loading:!0,error:null});try{const n=await t("/api/enhance-prompt",{method:"POST",body:a});return r.loading=!1,n}catch(n){throw r.loading=!1,r.error=n,n}}async function E(a,r,n,l=1,f=20){const c=new URLSearchParams;a&&c.append("category",a),r&&c.append("difficulty",r),n&&c.append("search",n),c.append("page",l.toString()),c.append("limit",f.toString());const u=`/api/templates?${c.toString()}`;return await t(u,{retry:2})}async function I(a){return await t(`/api/templates/${a}`,{retry:2})}async function S(a){return await t("/api/analyze-prompt",{method:"POST",body:{prompt:a}})}async function b(a,r,n){return await t("/api/export",{method:"POST",body:{content:a,format:r,metadata:n},retry:1})}async function C(){return await t("/api/health",{retry:1,cache:!0,cacheTime:w.ONE_MINUTE})}return{enhancePrompt:i,fetchTemplates:E,fetchTemplate:I,analyzePrompt:S,exportPrompt:b,checkHealth:C}}export{O as s,A as u};
