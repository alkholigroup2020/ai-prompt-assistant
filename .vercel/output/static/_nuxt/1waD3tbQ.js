import{u as A}from"./EyWWPEUR.js";import{e as D,c as o,r as E}from"./D_7VKaxR.js";const F=1440*60*1e3,r="prompt-templates-cache";function N(){try{const n=localStorage.getItem(r);if(!n)return null;const t=JSON.parse(n);if(Date.now()-t.timestamp<F)return t;localStorage.removeItem(r)}catch{localStorage.removeItem(r)}return null}function x(n,t){try{const i={templates:n,total:t,timestamp:Date.now()};localStorage.setItem(r,JSON.stringify(i))}catch(i){console.warn("Failed to cache templates:",i)}}function H(){const n=A(),t=D({templates:[],currentTemplate:null,loading:!1,error:null,filters:{category:null,difficulty:null,search:""},pagination:{page:1,limit:20,total:0,totalPages:0}});async function i(){t.loading=!0,t.error=null;try{const a=!t.filters.category&&!t.filters.difficulty&&!t.filters.search&&t.pagination.page===1;if(a){const l=N();if(l){t.templates=l.templates,t.pagination.total=l.total,t.pagination.totalPages=Math.ceil(l.total/t.pagination.limit),t.loading=!1;return}}const e=await n.fetchTemplates(t.filters.category||void 0,t.filters.difficulty||void 0,t.filters.search||void 0,t.pagination.page,t.pagination.limit);e.data&&(t.templates=e.data.templates,t.pagination.total=e.data.total,t.pagination.totalPages=Math.ceil(e.data.total/e.data.pageSize),a&&x(e.data.templates,e.data.total))}catch(a){throw t.error=a,a}finally{t.loading=!1}}async function p(a){t.loading=!0,t.error=null;try{const e=await n.fetchTemplate(a);e.data&&(t.currentTemplate=e.data)}catch(e){throw t.error=e,e}finally{t.loading=!1}}function s(a){t.filters.category=a,t.pagination.page=1}function c(a){t.filters.difficulty=a,t.pagination.page=1}function f(a){t.filters.search=a,t.pagination.page=1}function g(){t.filters.category=null,t.filters.difficulty=null,t.filters.search="",t.pagination.page=1}function u(a){a>=1&&a<=t.pagination.totalPages&&(t.pagination.page=a)}function m(){t.pagination.page<t.pagination.totalPages&&t.pagination.page++}function h(){t.pagination.page>1&&t.pagination.page--}async function d(a){f(a),await i()}async function y(a){s(a),await i()}async function T(a){c(a),await i()}function P(){t.currentTemplate=null}const w=o(()=>t.templates.length>0),C=o(()=>t.currentTemplate!==null),v=o(()=>t.filters.category!==null||t.filters.difficulty!==null||t.filters.search!==""),S=o(()=>t.pagination.page<t.pagination.totalPages),I=o(()=>t.pagination.page>1);return{state:E(t),fetchTemplates:i,fetchTemplate:p,setCategory:s,setDifficulty:c,setSearch:f,clearFilters:g,goToPage:u,nextPage:m,previousPage:h,search:d,filterByCategory:y,filterByDifficulty:T,clearCurrentTemplate:P,hasTemplates:w,hasCurrentTemplate:C,hasFilters:v,hasNextPage:S,hasPreviousPage:I}}export{H as u};
