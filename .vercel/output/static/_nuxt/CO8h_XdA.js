import{u as x,s as F}from"./EyWWPEUR.js";import{e as $,c as l,r as O}from"./D_7VKaxR.js";import{D as R,c as H}from"#entry";function M(){const c=x(),e=$({loading:!1,error:null,result:null,originalPrompt:""});async function s(r){e.loading=!0,e.error=null,e.result=null,e.originalPrompt=f(r);try{const o=await c.enhancePrompt(r);e.result=o}catch(o){throw e.error=o,o}finally{e.loading=!1}}function f(r){const o=[];return r.role&&o.push(`Role: ${r.role}`),r.audience&&o.push(`Audience: ${r.audience}`),r.task&&o.push(`Task: ${r.task}`),r.tone&&o.push(`Tone: ${r.tone}`),r.outputFormat&&o.push(`Output Format: ${r.outputFormat}`),r.constraints&&r.constraints.length>0&&o.push(`Constraints: ${r.constraints.join(", ")}`),r.examples&&o.push(`Examples: ${r.examples}`),r.context&&o.push(`Context: ${r.context}`),o.join(`

`)}function m(){e.loading=!1,e.error=null,e.result=null,e.originalPrompt=""}const g=l(()=>e.result!==null),d=l(()=>e.result?.data?.qualityScore||0),p=l(()=>e.result?.data?.enhancedPrompt||""),S=l(()=>e.result?.data?.improvements||[]),i=l(()=>e.result?.data?.suggestions||[]),h=l(()=>e.result?.data?.alternativeVersions||[]);return{state:O(e),enhance:s,clear:m,hasResult:g,qualityScore:d,enhancedPrompt:p,improvements:S,suggestions:i,alternativeVersions:h}}const U=1e4,L=10;function Q(){let c=null;function e(t,n){if(typeof window>"u")return n;try{const a=localStorage.getItem(t);return a?JSON.parse(a):n}catch{return n}}function s(t,n){if(!(typeof window>"u"))try{localStorage.setItem(t,JSON.stringify(n))}catch(a){console.error("Failed to save to localStorage:",a)}}function f(t){if(!(typeof window>"u"))try{localStorage.removeItem(t)}catch(n){console.error("Failed to remove from localStorage:",n)}}function m(){return e("user_preferences",H)}function g(t){s("user_preferences",t)}function d(){return e("form_draft",null)}function p(t){s("form_draft",t)}function S(){f("form_draft")}function i(){return e("prompt_history",[])}function h(t,n){const a=i(),y={id:`prompt_${Date.now()}`,timestamp:new Date,input:t,output:n,starred:!1};a.unshift(y);const v=a.slice(0,L);s("prompt_history",v)}function r(){s("prompt_history",[])}function o(){return e("user_stats",R)}function u(t){const a={...o(),...t,lastUsed:new Date};s("user_stats",a)}function _(){const t=o();u({totalPrompts:t.totalPrompts+1})}function A(){const t=o();u({totalSaved:t.totalSaved+1})}function E(){const t=o();u({totalExports:t.totalExports+1})}function w(t){const n=o(),a=n.totalPrompts,y=n.averageQualityScore,v=a===0?t:(y*a+t)/(a+1);u({averageQualityScore:Math.round(v)})}function P(){return{preferences:m(),currentDraft:d()||void 0,recentPrompts:i(),stats:o(),version:"1.0.0",lastSync:new Date}}function D(){if(!(typeof window>"u"))try{localStorage.clear()}catch(t){console.error("Failed to clear localStorage:",t)}}function T(t){c===null&&(c=F(()=>{const n=t();n.draft&&p(n)},U))}function I(){c!==null&&(clearInterval(c),c=null)}return{loadPreferences:m,savePreferences:g,loadDraft:d,saveDraft:p,clearDraft:S,loadHistory:i,saveToHistory:h,clearHistory:r,loadStats:o,updateStats:u,incrementPromptsEnhanced:_,incrementTemplatesUsed:A,incrementExports:E,updateAverageQualityScore:w,loadAllData:P,clearAllData:D,startAutoSave:T,stopAutoSave:I,getItem:e,setItem:s,removeItem:f}}export{Q as a,M as u};
